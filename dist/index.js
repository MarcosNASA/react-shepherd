var M=Object.defineProperty,V=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var w=(e,t,o)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,i=(e,t)=>{for(var o in t||(t={}))v.call(t,o)&&w(e,o,t[o]);if(m)for(var o of m(t))P.call(t,o)&&w(e,o,t[o]);return e},p=(e,t)=>V(e,_(t));var E=(e,t)=>{var o={};for(var r in e)v.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&m)for(var r of m(e))t.indexOf(r)<0&&P.call(e,r)&&(o[r]=e[r]);return o};import{Fragment as Z,createContext as x,createElement as h,useContext as C,useEffect as W,useMemo as S,useState as R}from"react";import{useLayoutEffect as L}from"react";var g=({component:e,useContext:t,index:o})=>{let[r,n]=t(),s=o!=null?o:r.findIndex(c=>e.element===c.element);return L(()=>{let{element:c}=e;if(!!c.current)return n(a=>[...a,p(i({},e),{index:s})].sort(({element:{current:u}={}}={},{element:{current:l}={}}={})=>u&&l&&u.compareDocumentPosition(l)&Node.DOCUMENT_POSITION_PRECEDING?1:-1).map((u,l)=>p(i({},u),{index:l}))),()=>{n(a=>a.filter(u=>u.element===c))}},[e,s,n,...Object.values(e)]),s};import{useEffect as H,useState as B}from"react";var I=({ref:e})=>{let[t,o]=B({x:0,y:0,height:0});return H(()=>{let r=e.current;if(!r)return;let n=()=>{o(r.getBoundingClientRect())},s=new MutationObserver(n),c=new ResizeObserver(n);return s.observe(r,{attributes:!0,attributeFilter:["style"]}),c.observe(document.body),()=>{s.disconnect(),c.disconnect()}},[o,e]),[t,o]};import{useEffect as j,useRef as G}from"react";import{useEffect as z,useState as U}from"react";var b=()=>{let[e,t]=U();return z(()=>{t(!0)},[]),e};var y=({delay:e,ref:t,shouldScrollIntoView:o})=>{let r=G(!1),n=b();j(()=>{if(!n||!o||!t.current||r.current)return;r.current=!0;let c=setTimeout(()=>{t.current.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},e);return()=>{clearTimeout(c)}},[e,n,t,o])};import X from"react-dom";var k=({children:e,container:t})=>X.createPortal(e,t);var O=e=>()=>{e(t=>p(i({},t),{activeSheep:t.activeSheep+1}))},F=e=>()=>{e(t=>p(i({},t),{activeSheep:t.activeSheep-1}))},xe=({children:e,id:t="shepherd-farmyard",zIndex:o=1})=>h("div",{id:t,style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",pointerEvents:"none",zIndex:o}},e),N=x(),A=x(),T=x(),f=()=>{let e=C(N);if(!e)throw new Error("useShepherdContext must be used within a ShepherdProvider");return e},D=()=>{let e=C(A);if(!e)throw new Error("useFlockContext must be used within a FlockProvider");return e},Y=()=>{let e=C(T);if(!e)throw new Error("useSheepContext must be used within a SheepProvider");return e},$={farmyardId:"shepherd-farmyard",shouldAutoScrollIntoView:!0},Ce=({children:e,options:t={}})=>{let[o,r]=R({activeSheep:0,options:i(i({},$),t)}),[n,s]=R([]);return h(N.Provider,{value:[o,r]},h(A.Provider,{value:[n,s]},e))},Re=({children:e})=>{let[{options:{farmyardId:t}}]=f(),[o,r]=R();return W(()=>{o||r(document.getElementById(t))},[t,o]),o?h(k,{container:o},e):null},q={delay:0},ve=({children:e,number:t,options:o={},spotRef:r})=>{let[{activeSheep:n}]=f(),s=S(()=>({element:r}),[r]),c=g({useContext:D,component:s,index:t}),d=S(()=>({number:c}),[c]),a=n===c;return!r.current||!a?null:h(T.Provider,{value:d},h(Q,{spotRef:r,options:i(i({},q),o)},e))},J=12,K=({position:e}={})=>(r={})=>{var n=r,{style:t}=n,o=E(n,["style"]);return i({style:i({position:"relative",width:`calc(100% - ${e.x}px)`,left:e.x+window.pageXOffset,top:Math.abs(e.y+e.height+window.pageYOffset+J),pointerEvents:"all"},t)},o)},Q=({children:e,options:t,spotRef:o})=>{let[r]=I({ref:o}),[n,s]=f(),{options:{shouldAutoScrollIntoView:c}}=n,[d]=D(),a=Y(),{delay:u}=t;return y({delay:u,ref:o,shouldScrollIntoView:c}),o.current?h(Z,null,typeof e=="function"?e(i({dismiss:()=>{s(l=>p(i({},l),{activeSheep:1/0}))},flockLength:d.length,getSheepProps:K({position:r}),goNextSheep:O(s),goPreviousSheep:F(s),position:r,sheep:a},n)):e):null},Pe=()=>{let[e,t]=f();return{shepherd:e,setShepherd:t,goNextSheep:S(()=>O(t),[t]),goPreviousSheep:S(()=>F(t),[t])}};export{xe as Farmyard,Re as Flock,ve as Sheep,Ce as ShepherdProvider,D as useFlockContext,Y as useSheepContext,Pe as useShepherd,f as useShepherdContext};

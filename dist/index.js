var D=Object.defineProperty,V=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var f=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var w=(e,r,t)=>r in e?D(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,i=(e,r)=>{for(var t in r||(r={}))C.call(r,t)&&w(e,t,r[t]);if(f)for(var t of f(r))P.call(r,t)&&w(e,t,r[t]);return e},p=(e,r)=>V(e,_(r));var R=(e,r)=>{var t={};for(var o in e)C.call(e,o)&&r.indexOf(o)<0&&(t[o]=e[o]);if(e!=null&&f)for(var o of f(e))r.indexOf(o)<0&&P.call(e,o)&&(t[o]=e[o]);return t};import{Fragment as K,createElement as d}from"react";import{createContext as m,useContext as S,useEffect as z,useMemo as A,useState as x}from"react";import{useLayoutEffect as L}from"react";var E=({component:e,useContext:r,index:t})=>{let[o,n]=r(),s=t!=null?t:o.findIndex(c=>e.element===c.element);return L(()=>{let{element:c}=e;if(!!c.current)return n(a=>[...a,p(i({},e),{index:s})].sort(({element:{current:l}={}}={},{element:{current:u}={}}={})=>l&&u&&l.compareDocumentPosition(u)&Node.DOCUMENT_POSITION_PRECEDING?1:-1).map((l,u)=>p(i({},l),{index:u}))),()=>{n(a=>a.filter(l=>l.element===c))}},[e,s,n,...Object.values(e)]),s};import{useEffect as B,useState as M}from"react";var b=({ref:e})=>{let[r,t]=M({x:0,y:0,height:0});return B(()=>{let o=e.current;if(!o)return;let n=()=>{t(o.getBoundingClientRect())},s=new MutationObserver(n),c=new ResizeObserver(n);return s.observe(o,{attributes:!0,attributeFilter:["style"]}),c.observe(document.body),()=>{s.disconnect(),c.disconnect()}},[t,e]),[r,t]};import{useEffect as H,useRef as U}from"react";var g=(e,r=0)=>new Promise(t=>{let o;o=requestAnimationFrame(()=>{o=requestAnimationFrame(()=>{o=setTimeout(e,r),t(o)})})}),y=e=>{clearTimeout(e),cancelAnimationFrame(e)};var O=({delay:e,ref:r,shouldScrollIntoView:t})=>{let o=U(!1);H(()=>{if(!t||!r.current||o.current)return;let n;return g(()=>{!r.current||(n=void 0,o.current=!0,r.current.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}))},e).then(s=>{n=s}),()=>{!n||y(n)}},[e,r,t])};import q from"react-dom";var k=({children:e,container:r})=>q.createPortal(e,r);var fe=({children:e,id:r="shepherd-farmyard",zIndex:t=1})=>d("div",{id:r,style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",pointerEvents:"none",zIndex:t}},e),F=m(),I=m(),N=m(),v=()=>{let e=S(F);if(!e)throw new Error("useShepherdContext must be used within a ShepherdProvider");return e},T=()=>{let e=S(I);if(!e)throw new Error("useFlockContext must be used within a SheepsProvider");return e},G=()=>{let e=S(N);if(!e)throw new Error("useSheepContext must be used within a SheepProvider");return e},j={initialDelay:0,farmyardId:"shepherd-farmyard",shouldAutoScrollIntoView:!0},me=({children:e,options:r={}})=>{let[t,o]=x({activeSheep:0,options:i(i({},j),r)}),[n,s]=x([]);return d(F.Provider,{value:[t,o]},d(I.Provider,{value:[n,s]},e))},Se=({children:e})=>{let[{options:{farmyardId:r}}]=v(),[t,o]=x();return z(()=>{t||o(document.getElementById(r))},[r,t]),t?d(k,{container:t},e):null},X={delay:0},xe=({children:e,number:r,options:t={},spotRef:o})=>{let[{activeSheep:n}]=v(),s=A(()=>({element:o}),[o]),c=E({useContext:T,component:s,index:r}),h=A(()=>({number:c}),[c]),a=n===c;return!o.current||!a?null:d(N.Provider,{value:h},d(J,{spotRef:o,options:i(i({},X),t)},e))},Y=12,$=({position:e}={})=>(o={})=>{var n=o,{style:r}=n,t=R(n,["style"]);return i({style:i({position:"relative",width:`calc(100% - ${e.x}px)`,left:e.x+window.pageXOffset,top:Math.abs(e.y+e.height+window.pageYOffset+Y),pointerEvents:"all"},r)},t)},J=({children:e,options:r,spotRef:t})=>{let[o]=b({ref:t}),[n,s]=v(),{options:{shouldAutoScrollIntoView:c}}=n,[h]=T(),a=G(),{delay:l}=r;return O({delay:l,ref:t,shouldScrollIntoView:c}),t.current?d(K,null,typeof e=="function"?e(i({dismiss:()=>{s(u=>p(i({},u),{activeSheep:1/0}))},flockLength:h.length,getSheepChildProps:$({position:o}),goNextSheep:()=>{s(u=>p(i({},u),{activeSheep:u.activeSheep+1}))},goPreviousSheep:()=>{s(u=>p(i({},u),{activeSheep:u.activeSheep-1}))},position:o,sheep:a},n)):e):null};export{fe as Farmyard,Se as Flock,xe as Sheep,me as ShepherdProvider,T as useFlockContext,G as useSheepContext,v as useShepherdContext};

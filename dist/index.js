var D=Object.defineProperty,L=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var d=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var g=(e,t,o)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,i=(e,t)=>{for(var o in t||(t={}))v.call(t,o)&&g(e,o,t[o]);if(d)for(var o of d(t))P.call(t,o)&&g(e,o,t[o]);return e},u=(e,t)=>L(e,_(t));var w=(e,t)=>{var o={};for(var r in e)v.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&d)for(var r of d(e))t.indexOf(r)<0&&P.call(e,r)&&(o[r]=e[r]);return o};import{Fragment as ee,createContext as x,createElement as l,useContext as R,useEffect as Z,useMemo as h,useState as C}from"react";import{useLayoutEffect as B}from"react";var y=({component:e,useContext:t,index:o})=>{let[r,n]=t(),s=o!=null?o:r.findIndex(c=>e.element===c.element);return B(()=>{let{element:c}=e;if(!!c.current)return n(a=>[...a,u(i({},e),{index:s})]),()=>{n(a=>a.filter(f=>f.element===c))}},[e,s,n,...Object.values(e)]),s};import{useEffect as z,useState as H}from"react";var E=({ref:e})=>{let[t,o]=H({x:0,y:0,height:0});return z(()=>{let r=e.current;if(!r)return;let n=()=>{o(r.getBoundingClientRect())},s=new MutationObserver(n),c=new ResizeObserver(n);return s.observe(r,{attributes:!0,attributeFilter:["style"]}),c.observe(document.body),()=>{s.disconnect(),c.disconnect()}},[o,e]),[t,o]};import{useEffect as X,useRef as G}from"react";import{useEffect as j,useState as U}from"react";var F=()=>{let[e,t]=U(!1);return j(()=>{t(!0)},[]),e};var b=({delay:e,ref:t,shouldScrollIntoView:o})=>{let r=G(!1),n=F();X(()=>{if(!n||!o||!t.current||r.current)return;r.current=!0;let c=setTimeout(()=>{t.current.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},e);return()=>{clearTimeout(c)}},[e,n,t,o])};import Y from"react-dom";var k=({children:e,container:t})=>Y.createPortal(e,t);var I=({setShepherd:e,flock:t})=>()=>{console.log(t),e(o=>u(i({},o),{activeSheep:Math.min(t.length,o.activeSheep+1)}))},O=({setShepherd:e})=>()=>{e(t=>u(i({},t),{activeSheep:Math.max(t.activeSheep-1,-1)}))},M=({setShepherd:e})=>()=>{e(t=>u(i({},t),{activeSheep:0}))},A=({setShepherd:e})=>()=>{e(t=>u(i({},t),{activeSheep:1/0}))},Re=({children:e,id:t="shepherd-farmyard",zIndex:o=1})=>l("div",{id:t,style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",pointerEvents:"none",zIndex:o}},e),N=x(),T=x(),V=x(),m=()=>{let e=R(N);if(!e)throw new Error("useShepherdContext must be used within a ShepherdProvider");return e},S=()=>{let e=R(T);if(!e)throw new Error("useFlockContext must be used within a FlockProvider");return e},$=()=>{let e=R(V);if(!e)throw new Error("useSheepContext must be used within a SheepProvider");return e},q={farmyardId:"shepherd-farmyard",shouldAutoScrollIntoView:!0},Ce=({children:e,options:t={}})=>{let[o,r]=C([]),[n,s]=C({activeSheep:0,options:i(i({},q),t)});return l(N.Provider,{value:[n,s]},l(T.Provider,{value:[o,r]},e))},ve=({children:e})=>{let[{options:{farmyardId:t}}]=m(),[o,r]=C();return Z(()=>{o||r(document.getElementById(t))},[t,o]),o?l(k,{container:o},e):null},J={delay:0},Pe=({children:e,number:t,options:o={},spotRef:r})=>{let[{activeSheep:n}]=m(),s=h(()=>({element:r}),[r]),c=y({useContext:S,component:s,index:t}),p=h(()=>({number:c}),[c]),a=n===c;return!r.current||!a?null:l(V.Provider,{value:p},l(W,{spotRef:r,options:i(i({},J),o)},e))},K=12,Q=({position:e}={})=>(r={})=>{var n=r,{style:t}=n,o=w(n,["style"]);return i({style:i({position:"relative",width:`calc(100% - ${e.x}px)`,left:e.x+window.pageXOffset,top:Math.abs(e.y+e.height+window.pageYOffset+K),pointerEvents:"all"},t)},o)},W=({children:e,options:t,spotRef:o})=>{let[r]=E({ref:o}),[n,s]=m(),{options:{shouldAutoScrollIntoView:c}}=n,[p]=S(),a=$(),{delay:f}=t;return b({delay:f,ref:o,shouldScrollIntoView:c}),o.current?l(ee,null,typeof e=="function"?e(i({closeFarmyard:A({setShepherd:s}),flock:p,flockLength:p.length,getSheepProps:Q({position:r}),goNextSheep:I({setShepherd:s,flock:p}),goPreviousSheep:O({setShepherd:s}),openFarmyard:M({setShepherd:s}),position:r,sheep:a},n)):e):null},ge=()=>{let[e,t]=m(),[o,r]=S();return{flock:o,setFlock:r,shepherd:e,setShepherd:t,goNextSheep:h(()=>I({setShepherd:t,flock:o}),[t,o]),goPreviousSheep:h(()=>O({setShepherd:t}),[t]),openFarmyard:h(()=>M({setShepherd:t}),[t]),closeFarmyard:h(()=>A({setShepherd:t}),[t])}};export{Re as Farmyard,ve as Flock,Pe as Sheep,Ce as ShepherdProvider,S as useFlockContext,$ as useSheepContext,ge as useShepherd,m as useShepherdContext};
